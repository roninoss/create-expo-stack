<% if (props.stylingPackage?.name === "nativewind") { %>
  import './global.css';
<% } else if (props.stylingPackage?.name === "nativewinui") { %>
  import './global.css';
  import 'expo-dev-client';
<% } %>
<% if (props.stylingPackage?.name === "unistyles") { %>
import './unistyles';
import { DefaultTheme, DarkTheme } from '@react-navigation/native';
import { useUnistyles } from 'react-native-unistyles';
import { useMemo } from 'react';
<% } else if (props.stylingPackage?.name === "nativewind" || props.stylingPackage?.name === "stylesheet") { %>
import { DefaultTheme, DarkTheme } from '@react-navigation/native';
import { useColorScheme } from 'react-native';
import { useMemo } from 'react';
<% } %>
<% if (props.internalizationPackage?.name === "i18next") { %>
  import './translation';
<% } %>
import "react-native-gesture-handler";

<% if (props.analyticsPackage?.name === "vexo-analytics") { %>
  import { vexo } from 'vexo-analytics';

  vexo(process.env.VEXO_API_KEY); // eslint-disable-line

  import Navigation from "./navigation"; // eslint-disable-line
<% } else { %>
  import Navigation from "./navigation";
<% } %>
<% if (props.authenticationPackage?.name === "convex") { %>
  import { ConvexReactClient } from "convex/react";
  import { ConvexBetterAuthProvider } from "@convex-dev/better-auth/react";
  import { authClient } from "@/lib/auth-client";

  const convex = new ConvexReactClient(process.env.EXPO_PUBLIC_CONVEX_URL as string, {
    // Optionally pause queries until the user is authenticated
    expectAuth: true, 
    unsavedChangesWarning: false, 
  });
<% } %>

export default function App() {
	<% if (props.stylingPackage?.name === "unistyles")  { %>
    const { theme: uniTheme, rt } = useUnistyles();

    const baseTheme = rt.colorScheme === 'dark' ? DarkTheme : DefaultTheme;
    const theme = useMemo(() => ({
      ...baseTheme,
      colors: {
        ...baseTheme.colors,
        background: uniTheme.colors.background,
        text: uniTheme.colors.typography,
        primary: uniTheme.colors.astral,
        secondary: uniTheme.colors.cornflowerBlue,
        border: uniTheme.colors.limedSpruce,
        card: uniTheme.colors.background,
        notification: uniTheme.colors.astral,
      },
    }), [baseTheme, uniTheme.colors.background, uniTheme.colors.typography, uniTheme.colors.astral, uniTheme.colors.cornflowerBlue, uniTheme.colors.limedSpruce]);
  <% } %>
  <% if (props.stylingPackage?.name === "nativewind" || props.stylingPackage?.name === "stylesheet") { %>
    const colorScheme = useColorScheme();
		const theme = useMemo(() => colorScheme === 'dark' ? DarkTheme : DefaultTheme, [colorScheme]);
  <% } %>

  return (
    <% if (props.stylingPackage?.name === "nativewind" || props.stylingPackage?.name === "stylesheet" || props.stylingPackage?.name === "unistyles") { %>
      <% if (props.authenticationPackage?.name === "convex") { %>
        <ConvexBetterAuthProvider client={convex} authClient={authClient}>
          <Navigation theme={theme} />
        </ConvexBetterAuthProvider>
      <% } else {%>
        <Navigation theme={theme} />
      <%}%>
    <% } else { %>
      <% if (props.authenticationPackage?.name === "convex") { %>
        <ConvexBetterAuthProvider client={convex} authClient={authClient}>
          <Navigation />
        </ConvexBetterAuthProvider>
      <% } else {%>
        <Navigation />
      <%}%>
    <% } %>
  )
}
