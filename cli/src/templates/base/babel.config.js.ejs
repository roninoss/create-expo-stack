module.exports = function(api) {
  api.cache(true);
  let plugins = [];

  <% if (props.stylingPackage?.name === "unistyles") { %>
    plugins.push([
      'react-native-unistyles/plugin',
      {
        autoProcessRoot: 'app',
        autoProcessImports: ['~/components']
      }
    ]);
  <% } %>

  <% if (props.authenticationPackage?.name === "convex") { %>
    plugins.push([
      "module-resolver",
      {
        alias: {
          "better-auth/react": "./node_modules/better-auth/dist/client/react/index.cjs",
          "better-auth/client/plugins": "./node_modules/better-auth/dist/client/plugins/index.cjs",
          "@better-auth/expo/client": "./node_modules/@better-auth/expo/dist/client.cjs",
        },
      },
    ]);
  <% } %>

  plugins.push('react-native-worklets/plugin');

  return {
    <% if (props.stylingPackage?.name === "nativewind" || props.stylingPackage?.name === "nativewindui") { %>
      presets: [
        ['babel-preset-expo', { jsxImportSource: 'nativewind' }],
        'nativewind/babel',
      ],
    <% } else { %>
      presets: ['babel-preset-expo'],
    <% } %>
    plugins,
  };
};
